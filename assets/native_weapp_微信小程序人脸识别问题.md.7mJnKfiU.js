import{_ as t}from"./chunks/CustomLink.HhFLulSs.js";import{_ as l,o as p,c as o,m as s,J as e,a,a8 as c}from"./chunks/framework.QttzOlP4.js";const C=JSON.parse('{"title":"微信小程序 ---人脸识别","description":"","frontmatter":{},"headers":[],"relativePath":"native/weapp/微信小程序人脸识别问题.md","filePath":"native/weapp/微信小程序人脸识别问题.md","lastUpdated":1700734386000}'),r={name:"native/weapp/微信小程序人脸识别问题.md"},y=s("h1",{id:"微信小程序-人脸识别",tabindex:"-1"},[a("微信小程序 ---人脸识别 "),s("a",{class:"header-anchor",href:"#微信小程序-人脸识别","aria-label":'Permalink to "微信小程序 ---人脸识别"'},"​")],-1),F=s("p",null,[s("strong",null,[a("微信小程序 ---人脸识别（"),s("code",null,"wx.startFacialRecognitionVerify"),a("）")])],-1),i=s("p",null,[s("strong",null,"由于人脸核验功能涉及到用户的敏感、隐私信息，因此调用此接口的业务方，需要满足一定的条件，申请小程序的人脸识别api。开通小程序后台的接口权限入口后，开发者可以登录mp.weixin.qq.com小程序账号，在设置-接口能力中，开通接口能力")],-1),D=s("li",null,[s("p",null,[s("strong",null,"活体检测，是否支持人脸识别")])],-1),d=c(`<div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#BABED8;">wx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">checkIsSupportFacialRecognition</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">　　checkAliveType</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 2</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">　　success</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;"> function</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">　　　　if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">res</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">errCode</span><span style="color:#89DDFF;"> ===</span><span style="color:#F78C6C;"> 0</span><span style="color:#89DDFF;"> ||</span><span style="color:#BABED8;"> res</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">errMsg</span><span style="color:#89DDFF;"> ===</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">checkIsSupportFacialRecognition:ok</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">　　　　　　//调用人脸识别</span></span>
<span class="line"><span style="color:#BABED8;">　　　　　　_this</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">startface</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">_this</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">data</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">custName</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">replace</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">/(</span><span style="color:#89DDFF;font-style:italic;">^</span><span style="color:#C3E88D;">\\s</span><span style="color:#89DDFF;">*)|(</span><span style="color:#C3E88D;">\\s</span><span style="color:#89DDFF;">*)</span><span style="color:#89DDFF;font-style:italic;">$</span><span style="color:#89DDFF;">/</span><span style="color:#F78C6C;">g</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> _this</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">data</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">custIdCard</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;font-style:italic;"> //身份证名称，身份证号码</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">　　　　　　return</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">　　　　}</span></span>
<span class="line"><span style="color:#BABED8;">　　　　wx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">showToast</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">微信版本过低，暂时无法使用此功能，请升级微信最新版本</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">　　},</span></span>
<span class="line"><span style="color:#82AAFF;">　　fail</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;font-style:italic;"> res</span><span style="color:#C792EA;"> =&gt;</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">　　　　wx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">showToast</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">微信版本过低，暂时无法使用此功能，请升级微信最新版本</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">　　}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span></code></pre></div><ul><li><p><strong>兼容版本</strong></p></li><li><p>读数字：android 微信6.5.4及以上版本, iOS 微信6.5.6及以上版本</p></li><li><p>屏幕闪烁：android 微信6.7.2及以上版本, iOS 微信6.7.2及以上版本</p></li><li><p>开放状态：未开放</p></li><li><p>开放范围：白名单</p></li></ul><p><strong>OBJECT</strong> 参数说明</p><table><thead><tr><th>参数</th><th>类型</th><th>是否必填</th><th>说明</th></tr></thead><tbody><tr><td>name</td><td>String</td><td>是</td><td>姓名</td></tr><tr><td>idCardNumber</td><td>String</td><td>是</td><td>身份证号码</td></tr><tr><td>success</td><td>Function</td><td>否</td><td>调用成功回调</td></tr><tr><td>fail</td><td>Function</td><td>否</td><td>调用失败回调</td></tr><tr><td>complete</td><td>Function</td><td>是</td><td>调用完成回调(不管成功失败都会回调)</td></tr><tr><td>checkAliveType</td><td>Number</td><td>是</td><td>人脸核验交互方式，默认<em>读数字</em>(0)(见表1)</td></tr></tbody></table><p><strong>表1</strong> checkAliveType参数的类型</p><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">解释</th></tr></thead><tbody><tr><td style="text-align:left;">0</td><td style="text-align:left;">读数字(默认)</td></tr><tr><td style="text-align:left;">1</td><td style="text-align:left;">屏幕闪烁</td></tr><tr><td style="text-align:left;">2</td><td style="text-align:left;">先检查是否为屏幕闪烁，不可以则自动读数字</td></tr></tbody></table><p><strong>CALLBACK</strong> 返回参数</p><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">类型</th><th style="text-align:left;">解释</th></tr></thead><tbody><tr><td style="text-align:left;">errMag</td><td style="text-align:left;">String</td><td style="text-align:left;">错误信息</td></tr><tr><td style="text-align:left;">errCode</td><td style="text-align:left;">Number</td><td style="text-align:left;">错误码</td></tr><tr><td style="text-align:left;">verifyResult</td><td style="text-align:left;">String</td><td style="text-align:left;">本次认证结果凭据，第三方可以选择根据这个凭据获取相关信息</td></tr></tbody></table><ul><li><p>errCode: 0, 识别成功</p></li><li><p>errMsg: &#39;startFacialRecognitionVerify:ok&#39;</p></li><li><p><strong>示例代码</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#676E95;font-style:italic;">  //人脸识别，请求进行基于生物识别的人脸核身</span></span>
<span class="line"><span style="color:#82AAFF;">  startface</span><span style="color:#BABED8;">(name</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> idcard) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  　　wx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">startFacialRecognitionVerify</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">　</span></span>
<span class="line"><span style="color:#F07178;">  　　　　name</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> _this</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">data</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">custName</span><span style="color:#89DDFF;">,</span><span style="color:#676E95;font-style:italic;">//身份证名称</span></span>
<span class="line"><span style="color:#F07178;">  　　　　idCardNumber</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> _this</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">data</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">custIdCard</span><span style="color:#89DDFF;">,</span><span style="color:#676E95;font-style:italic;">//身份证号码</span></span>
<span class="line"><span style="color:#82AAFF;">  　　　　success</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;"> function</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#C792EA;">  　　　　　　var</span><span style="color:#BABED8;"> verifyResult</span><span style="color:#89DDFF;"> =</span><span style="color:#BABED8;"> res</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">verifyResult</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;font-style:italic;">//认证结果</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">  　　　　　　//调用接口</span></span>
<span class="line"><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#89DDFF;">  　　　　},</span></span>
<span class="line"><span style="color:#F07178;">  　　　　checkAliveType</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 2</span><span style="color:#89DDFF;">,</span><span style="color:#676E95;font-style:italic;">//屏幕闪烁(人脸核验的交互方式，默认0,读数字)</span></span>
<span class="line"><span style="color:#82AAFF;">  　　　　fail</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;font-style:italic;"> err</span><span style="color:#C792EA;"> =&gt;</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">  　　　　　　wx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">showToast</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">请保持光线充足，面部正对手机，且无遮挡</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">  　　　　}</span></span>
<span class="line"><span style="color:#89DDFF;">  　　}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">  }</span></span></code></pre></div></li></ul>`,9);function A(B,f,h,g,u,_){const n=t;return p(),o("div",null,[y,F,s("ul",null,[s("li",null,[i,e(n,{title:"微信开发者工具开发文档",href:"https://developers.weixin.qq.com/community/business/doc/000842c329c3f811b7678b8165100d"})]),D]),d])}const x=l(r,[["render",A]]);export{C as __pageData,x as default};
